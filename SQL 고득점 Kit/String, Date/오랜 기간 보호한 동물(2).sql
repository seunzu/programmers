USE programmers_string_date;

CREATE TABLE ANIMAL_INS2 (
    ANIMAL_ID VARCHAR(20) PRIMARY KEY NOT NULL,
    ANIMAL_TYPE VARCHAR(20) NOT NULL,
    DATETIME DATETIME NOT NULL,
    INTAKE_CONDITION VARCHAR(20) NOT NULL,
    NAME VARCHAR(50),
    SEX_UPON_INTAKE VARCHAR(20) NOT NULL
);

CREATE TABLE ANIMAL_OUTS (
	ANIMAL_ID VARCHAR(20) PRIMARY KEY NOT NULL,
    ANIMAL_TYPE VARCHAR(20) NOT NULL,
    DATETIME DATETIME NOT NULL,
    NAME VARCHAR(50),
    SEX_UPON_OUTCOME VARCHAR(20) NOT NULL,
    FOREIGN KEY (ANIMAL_ID) REFERENCES ANIMAL_INS2(ANIMAL_ID)
);

SHOW TABLES;

INSERT INTO ANIMAL_INS2 (ANIMAL_ID, ANIMAL_TYPE, DATETIME, INTAKE_CONDITION, NAME, SEX_UPON_INTAKE)
VALUES 
    ('A354597', 'Cat', '2014-05-02 12:16:00', 'Normal', 'Ariel', 'Spayed Female'),
    ('A362707', 'Dog', '2016-01-27 12:27:00', 'Sick', 'Girly Girl', 'Spayed Female'),
    ('A370507', 'Cat', '2014-10-27 14:43:00', 'Normal', 'Emily', 'Spayed Female'),
    ('A414513', 'Dog', '2016-06-07 09:17:00', 'Normal', 'Rocky', 'Neutered Male');

INSERT INTO ANIMAL_OUTS (ANIMAL_ID, ANIMAL_TYPE, DATETIME, NAME, SEX_UPON_OUTCOME)
VALUES 
    ('A354597', 'Cat', '2014-06-03 12:30:00', 'Ariel', 'Spayed Female'),
    ('A362707', 'Dog', '2017-01-10 10:44:00', 'Girly Girl', 'Spayed Female'),
    ('A370507', 'Cat', '2015-08-15 09:24:00', 'Emily', '');

SELECT * FROM ANIMAL_INS2;

SELECT * FROM ANIMAL_OUTS;

SELECT 
    I.ANIMAL_ID, I.NAME
FROM
    ANIMAL_INS AS I
        JOIN
    ANIMAL_OUTS AS O USING (ANIMAL_ID)
ORDER BY DATEDIFF(O.DATETIME, I.DATETIME) DESC
LIMIT 2;