USE programmers_groupBy;

CREATE TABLE APPOINTMENT (
    APNT_YMD TIMESTAMP NOT NULL,
    APNT_NO INT NOT NULL,
    PT_NO VARCHAR(10) NOT NULL,
    MCDP_CD VARCHAR(6) NOT NULL,
    MDDR_ID VARCHAR(10) NOT NULL,
    APNT_CNCL_YN VARCHAR(1),
    APNT_CNCL_YMD DATE,
    PRIMARY KEY (APNT_YMD, APNT_NO)
);

SHOW TABLES;

INSERT INTO APPOINTMENT (APNT_YMD, APNT_NO, PT_NO, MCDP_CD, MDDR_ID, APNT_CNCL_YN, APNT_CNCL_YMD)
VALUES
    ('2022-04-14 09:30:00', 47, 'PT22000064', 'GS', 'DR20170123', 'N', NULL),
    ('2022-04-15 10:30:00', 48, 'PT22000065', 'OB', 'DR20100231', 'N', NULL),
    ('2022-05-15 17:30:00', 49, 'PT22000086', 'OB', 'DR20100231', 'N', NULL),
    ('2022-05-18 10:30:00', 52, 'PT22000019', 'GS', 'DR20100039', 'N', NULL),
    ('2022-05-19 12:00:00', 53, 'PT22000020', 'FM', 'DR20010112', 'N', NULL),
    ('2022-05-22 08:30:00', 54, 'PT22000021', 'GS', 'DR20100039', 'N', NULL),
    ('2022-05-04 10:30:00', 56, 'PT22000023', 'FM', 'DR20090112', 'N', NULL),
    ('2022-05-14 15:30:00', 57, 'PT22000074', 'CS', 'DR20200012', 'N', NULL),
    ('2022-05-24 15:30:00', 58, 'PT22000085', 'CS', 'DR20200012', 'N', NULL),
    ('2022-05-28 10:00:00', 60, 'PT22000092', 'OS', 'DR20100031', 'N', NULL);
    
SELECT * FROM APPOINTMENT;

SELECT MCDP_CD AS '진료과코드', COUNT(*) AS '5월예약건수' 
FROM APPOINTMENT
WHERE APNT_YMD LIKE '2022-05%'
GROUP BY 1
ORDER BY 2, 1;